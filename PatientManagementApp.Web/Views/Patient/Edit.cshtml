@using PatientManagementApp.Web.ViewModels.PatientViewModels;
@using static PatientManagementApp.Common.ModelValidationConstraints.Global;
@model EditPatientViewModel;

@{
    ViewBag.Title = "Edit Patient Details";
    var today = DateTime.UtcNow.ToString(DateFormatString);
}

<div class="container mt-5">
    <h2 class="text-center">@ViewBag.Title</h2>
    <hr />

    <div class="row justify-content-center">
        <div class="col-lg-8 col-xl-6">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="card-title text-center">Update Details for @Model.FirstName @Model.LastName</h5>
                </div>
                <div class="card-body">
                    <form asp-action="Edit" method="post">
                        <input type="hidden" asp-for="PractitionerId" />
                        <input type="hidden" asp-for="EmergencyContactId" />

                        <h5 class="text-muted mb-3">Personal Details</h5>
                        <div class="mb-3">
                            <label asp-for="FirstName" class="form-label">First Name</label>
                            <input asp-for="FirstName" class="form-control" />
                            <span asp-validation-for="FirstName" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="LastName" class="form-label">Last Name</label>
                            <input asp-for="LastName" class="form-control" />
                            <span asp-validation-for="LastName" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="DateOfBirth" class="form-label">Date of Birth</label>
                            <input asp-for="DateOfBirth" class="form-control" value="@(string.IsNullOrEmpty(Model.DateOfBirth) ? today : Model.DateOfBirth)" />
                            <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Age" class="form-label">Age</label>
                            <input asp-for="Age" class="form-control" />
                            <span asp-validation-for="Age" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Gender" class="form-label">Gender</label>
                            <select asp-for="Gender" asp-items="Model.GenderOptions" class="form-select"></select>
                            <span asp-validation-for="Gender" class="text-danger"></span>
                        </div>

                        <h5 class="text-muted mb-3">Contact Information</h5>
                        <div class="mb-3">
                            <label asp-for="Email" class="form-label">Email</label>
                            <input asp-for="Email" class="form-control" placeholder="Optional" />
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="PhoneNumber" class="form-label">Phone Number</label>
                            <input asp-for="PhoneNumber" class="form-control" />
                            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                        </div>

                        <h5 class="text-muted mb-3">Treatment Details</h5>
                        <div class="mb-3">
                            <label asp-for="ImportantInfo" class="form-label">Important Information</label>
                            <textarea asp-for="ImportantInfo" class="form-control" rows="3"></textarea>
                            <span asp-validation-for="ImportantInfo" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Diagnosis" class="form-label">Diagnosis</label>
                            <textarea asp-for="Diagnosis" class="form-control" rows="3"></textarea>
                            <span asp-validation-for="Diagnosis" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="ReasonForVisit" class="form-label">Reason for Visit</label>
                            <textarea asp-for="ReasonForVisit" class="form-control" rows="3"></textarea>
                            <span asp-validation-for="ReasonForVisit" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="ReferredBy" class="form-label">Referred By</label>
                            <textarea asp-for="ReferredBy" class="form-control" rows="2"></textarea>
                            <span asp-validation-for="ReferredBy" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Status" class="form-label">Status</label>
                            <select asp-for="Status" asp-items="Model.PatientStatusOptions" class="form-select"></select>
                            <span asp-validation-for="Status" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="TreatmentStartDate" class="form-label">Treatment Start Date</label>
                            <input asp-for="TreatmentStartDate" class="form-control" value="@(string.IsNullOrEmpty(Model.TreatmentStartDate) ? today : Model.TreatmentStartDate)" />
                            <span asp-validation-for="TreatmentStartDate" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="TreatmentEndDate" class="form-label">Treatment End Date</label>
                            <input asp-for="TreatmentEndDate" class="form-control"  />
                            <span asp-validation-for="TreatmentEndDate" class="text-danger"></span>
                        </div>

                        <h5 class="text-muted mb-3">Emergency Contact</h5>
                        <div class="mb-3">
                            <label asp-for="EmergencyContactName" class="form-label">Name</label>
                            <input asp-for="EmergencyContactName" class="form-control" />
                            <span asp-validation-for="EmergencyContactName" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="EmergencyContactPhoneNumber" class="form-label">Phone Number</label>
                            <input asp-for="EmergencyContactPhoneNumber" class="form-control" />
                            <span asp-validation-for="EmergencyContactPhoneNumber" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label asp-for="EmergencyContactRelationship" class="form-label">Relationship</label>
                            <input asp-for="EmergencyContactRelationship" class="form-control" />
                            <span asp-validation-for="EmergencyContactRelationship" class="text-danger"></span>
                        </div>

                        <button type="submit" class="btn btn-primary w-100 mt-3">
                            <i class="bi bi-check-circle"></i> Confirm
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
